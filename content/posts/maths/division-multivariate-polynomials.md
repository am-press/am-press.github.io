---
author: "Pantelis Sopasakis"
title:  "Division of multivariate polynomials"
date: 2025-08-03
description: "Division of multivariate polynomials"
summary: "Division of multivariate polynomials"
math: true
series: ["Mathematix"]
tags: ["Algebra"]
collapsible: true
---


<p><strong>See also:</strong> <a href="../ideal-generated-by-polynomials">Ideal generated by polynomials</a>, <a href="../monomial-orderings">Monomial orderings</a></p>

<p>The objective is to perform a sort of multivariate division of polynomials that has the form<sup>[<a href="#references">1</a>]</sup></p> 
<p>$$f = q_1f_1 + \ldots + q_sf_s + r,$$</p>
<p>where we have multiple quotients—$q_1,\ldots,q_s$—and multiple divisors—$f_1,\ldots, f_s$—and a residual, $r$.</p>

## Example 1

<p>We start with a <em>benign</em> case. We will divide $f(x, y) = xy^2+1$ by $f_1(x, y) = xy+1$ and $f_2(x, y) = y+1$. The division looks like this:</p>

<div id="fig1">
    <img src="/IMG_A936BA3B2655-1.jpeg" alt="Polynomial division"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 1.</strong> Polynomial to be divided by two other polynomials.</em></p>
</div>

<p>That is, we have two divisors and we'll have two quotients (but one residual).</p>

<p>We use the <a href="../monomial-orderings#lex">lex</a> ordering $x > y$.  Before we proceed, note</p>

| Term   | Multiindex | Degree |
| ------ | ---------- | ------ |
| $xy^2$ | $(1, 2)$   | $3$    |
| $xy$   | $(1, 1)$   | $2$    |
| $y$    | $(0, 1)$   | $1$    |
| $1$    | $(0, 0)$   | 0      |

<p>Using the <a href="../monomial-orderings#lex">lex</a> ordering we have $xy^2 > xy > y > 1$.</p> 

<p>We start the division like we'd do in the univariate case: we identify the leading terms (this is conditioned by the choice of ordering) and divide:</p>

<div id="fig2">
    <img src="/IMG_4F227F5AF075-1.jpeg" alt="Polynomial division: step 1"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 2.</strong> Step 1.</em></p>
</div>

<p>We cannot continue to divide by $xy+1$ because $xy$ does not divide $-y$. We continue with $f_2=y+1$:</p>

<div id="fig3">
    <img src="/IMG_F89FE5C9C37B-1.jpeg" alt="Polynomial division: step 2"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 3.</strong> Step 2.</em></p>
</div>

<p>We conclude that </p>
<p>$$xy^2+1 = y(xy+1) + y(y+1) + 2.$$</p>

<p>This was... misleadingly easy!</p>

## Example 2

<p>This is a problematic case. We want to divide $f=x^2y+xy^2+y^2$ by $f_1=xy-1$ and $f_2=y^2-1$ in the <a href="../monomial-orderings">lexicographic order</a>. We proceed as above, but at some point we get stuck...</p>

<div id="fig4">
    <img src="/IMG_738C9DD0D01E-1.jpeg" alt="Polynomial division: problematic case"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 4.</strong> Polynomial division: the issue is that the leading term of $y^2-1$ does not divide the leading term of the remainder (which is $x$).</em></p>
</div>

<p>The problem is that neither $xy$ nor $y^2$ divides the <a href="../monomial-orderings">leading term</a> of the current residual, $y^2+x+y$. However, $y^2$ <strong>divides a non-leading term</strong>: $y^2$. This is unexpected — it would never happen in the univariate case!</p>

<div id="fig5">
    <img src="/IMG_1EEDE06F7D7B-1.jpeg" alt="Polynomial division: problematic case (a remedy)"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 5.</strong> Polynomial division: the divisor divides a non-leading term.</em></p>
</div>


<p>So the "workaround" is to move the leading term ($x$) of $r_1$ to the side and check whether $y^2$ (of $f_2$) divides the residual (having removed the leading term, $x$):</p>

<div id="fig6">
    <img src="/IMG_E8EE4A0C3838-1.jpeg" alt="Polynomial division: workaround"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 6.</strong> Polynomial division - workaround: setting aside the term of the residual that cannot be divided.</em></p>
</div>

<p>Once we move $x$ to the side we can divide by $y^2-1$:</p>

<div id="fig7">
    <img src="/IMG_45155468327B-1.jpeg" alt="Polynomial division: workaround"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 7.</strong> Polynomial division: we can now divide.</em></p>
</div>

<p>Now we should really stop. We have</p> 
<p>$$x^2y+xy^2+y^2 = (xy-1)\cdot (x+y) + (y^2-1)\cdot 1 + (x+y+1).$$</p>


### A multivariate division algorithm

<p>Cox et al.<sup>[<a href="#references">1</a>]</sup> give this division algorithm:</p>

```js
% Input: f1, ..., fs, f
% Output: q1, .., qs, r

q1 = 0; ...; qs = 0; r = 0
while p ≠ 0 do
    i = 1
    division_occurred = false
    while i ≤ s and division_occurred == false do
        if lt(fi) divides lt(p)
            qi = qi + lt(p) / lt(fi)
            p = p - ( lt(p) / lt(fi) ) * fi
            division_occurred = true
        else
            i = i + 1
    if division_occurred == false
        r = r + lt(p)
        p = p - lt(p)

    return q1, ..., qs, r
```


### Conclusion
<!-- ^610ed0 -->

<p>Let ${}>{}$ be a <a href="../monomial-orderings">monomial ordering</a> on $\N^n$ (i.e., on $k[x_1,\ldots, x_n]$), let $f\in k[x_1,\ldots, x_n]$, which we want to divide by $f_1, \ldots, f_s$. The order of $f_1, \ldots, f_s$ is important. Then,</p>
<p>$$f = a_1f_1 + \ldots + a_s f_s + r,$$</p>
<p>where $a_i\in k[x_1,\ldots, x_n]$ for $i=1,\ldots, s$, and</p>
<ul>
    <li>either $r=0$, or </li>
    <li>$r$ is a polynomial whose monomials are not divisible by any of $\operatorname{lt}(f_1), \ldots, \operatorname{lt}(f_s)$</li>
</ul>
<p>The polynomial $r$ is called the <strong>remainder</strong> of the division. </p>

<p>Furthermore, for $a_if_i\neq 0$,</p>
<p>$$\operatorname{multideg}f \geq \operatorname{multideg}(a_if_i),$$</p>
<p>and</p>
<p>$$\operatorname{multideg}f \geq \operatorname{multideg}r.$$</p>

### Ideal membership?

<p>If the remainder of a division is zero, we'll have</p>
<p>$$f=a_1f_1+a_2f_2,$$</p>
<p>i.e., $f\in \langle f_1, f_2\rangle$. The problem is that if $r\neq 0$ this doesn't imply that $f\notin \langle f_1, f_2\rangle$. Here's an example:</p>

<p>Suppose we want to divide $f=xy^2-x$ by $f_1=xy+1$ and $f_2=y^2+1$ (in this order and using the lexicographic order). We have</p>

<div id="fig8">
    <img src="/IMG_65395274439F-1.jpeg" alt="Polynomial division"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 8.</strong> Polynomial division by $f_1$ and $f_2$.</em></p>
</div>

<p>which means that </p>
<p>$$xy^2-x = y(xy+1) + 0(y^2+1) + (-x-y),$$</p>
<p>so we have a nonzero residual. But if we divide by $(f_2, f_1)$ we get a different result.</p>

<div id="fig9">
    <img src="/IMG_0425120FD28B-1.jpeg" alt="Polynomial division: different result"  style="width: 55%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 9.</strong> Polynomial division by $f_2$ and $f_1$: different result.</em></p>
</div>

<p>Now the residual is zero. This means that </p>
<p>$$xy^2-x \in \langle y^2+1, xy+1\rangle,$$</p>
<p>but we couldn't have concluded this when we divided by $(f_1, f_2)$.</p>


## Exercises

<div style="border-style:solid;border-width:1.5px;padding: 10px 15px 0px 10px; margin-bottom: 10px" id="ex1">
    <p><strong>Exercise 1: division.</strong> 
    Compute the remainder on division of the given polynomial $f$ by the ordered set $F$ (by hand). Use the `grlex` order, then the `lex` order in each case:</p>
    <p>$$f =x^7y^2 +x^3y^2 −y+1, F=(xy^2 −x,x−y^3).$$</p>
</div>

<p><em>Solution.</em> Firstly, let us use the <a href="../monomial-orderings">lexicographic order</a>. We write the above polynomials with their terms in descending order. </p>
<p>$$f = x^7y^2 +x^3y^2 −y+1, f_1 = xy^2 −x, f_2 = x - y^3.$$</p>

<div id="fig10">
    <img src="/IMG_95B3C08F3DDA-1.jpeg" alt="Polynomial division: different result"  style="width: 85%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 10.</strong> Polynomial division of $f$ by $F$.</em></p>
</div>

<p>Then,</p>

<div id="fig11">
    <img src="/IMG_AFE9388F083F-2.jpeg" alt="Polynomial division: different result"  style="width: 85%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 11.</strong> Polynomial division of $f$ by $F$: division is not possible.</em></p>
</div>


<p>since division is not possible we proceed to the the next polynomial, that is, $f_2$,</p>

<div id="fig12">
    <img src="/IMG_0A18872551F1-1.jpeg" alt="Polynomial division: different result"  style="width: 85%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 12.</strong> Polynomial division of $f$ by $F$: division is not possible.</em></p>
</div>

<p>The division is successful, so <strong>we reset</strong> $i$ and we set $i=1$. We don't keep dividing by $f_2$, we continue with the <em>default</em> divisor; here $f_2$ was an alternative divisor (our plan B)...</p>

<div id="fig13">
    <img src="/IMG_5804D7DCDE3E-1.jpeg" alt="Polynomial division: different result"  style="width: 85%; margin-left: auto;margin-right: auto;">
    <p><em><strong>Figure 13.</strong> Polynomial division of $f$ by $F$: division is not possible.</em></p>
</div>

<p>Continuing like this we find that </p>
<p>$$f=q_1f_1 + q_2f_2 + r,$$</p>
<p>where</p>
<p>$$\begin{aligned}
q_1 {}={}& x^6 + x^5y + x^4y^2 + x^4 + x^3y + x^2y^2 + 2x^2 + 2xy + 2y^2 + 2,
\\
q_2 {}={}& x^6 + x^5y + x^4 + x^3y + 2x^2 + 2xy + 2,
\\
r {}={}& 2y^3 -y + 1.
\end{aligned}$$</p>
<p>If we perform the division in the order $(f_2, f_1)$ we find</p>
<p>$$f = a_2f_2 + a_1f_1 + \rho,$$</p>
<p>where</p>
<p>$$\begin{aligned}
a_2 {}={}& x^6y^2 + x^5y^5 + x^4y^8 + x^3y^{11} + x^2y^{14} + x^2y^2 + xy^{17} + xy^5 + y^{20} + y^8,
\\
a_1 {}={}& 0,
\\
\rho {}={}& y^{23} + y^{11} -y + 1.
\end{aligned}$$</p>
<p>This is a super weird result because both the quotients and the residual <em>seem</em> to be of higher order than $f$, but this is not the case in the <a href="../monomial-orderings#lex">lexicographic order</a>. Note that we have large powers of $y$ there—not of $x$. Let's see how the results look like in the <a href="../monomial-orderings#grlex">graded lexicographic order</a>. If we divide by $(f_1, f_2)$ we get</p>
<p>$$f = b_1f_1 + b_2f_2 + s,$$</p>
<p>where $b_1=x^6+x^2$, $b_2=0$, and $s=x^7 + x^3 -y + 1$.</p>

<p>If we divide by $(f_2, f_1)$ we get the result</p>
<p>$$f=w_2f_2 + w_1f_1 + v,$$</p>
<p>where $w_2=0$, $w_1=x^2+x^2$, and $v=x^7 + x^3 -y + 1$—essentially the same result; there is a symmetry here (not sure whether this holds always for this monomial order, but I doubt it). $\bullet$</p>
 

<div style="border-style:solid;border-width:1.5px;padding: 10px 15px 0px 10px; margin-bottom: 10px" id="ex1">
    <p><strong>Exercise 2: division.</strong> 
    Divide $f=xy^2z^2 + xy - yz$ by $f_1=x- y^2$, $f_2=y - z^3$, $f_3=z^2 - 1$. Try different monomial orderings and different orders of the divisors.</p>
</div>

<p>In general</p>
<p>$$f=q_1f_1 + q_2f_2 + q_3f_3 + r,$$</p>

<p><strong>Division by $(f_1, f_2, f_3)$ with <a href="../monomial-orderings#lex">lex</a>:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& y^2z^2 + y,\\
q_2 {}={}& y^3z^2 + y^2z^5 + y^2 + yz^8 + yz^3 + z^{11} + z^6 - z,\\
q_3 {}={}& z^{12} + z^{10} + z^8 + z^7 + z^6 + z^5 + z^4 + z^3 + z,\\
r {}={}& z.
\end{aligned}$$</p>
<p>Again here we see some large powers like 10, 11, and 12.</p>

<p><strong>Division by $(f_3, f_1, f_2)$ with lex:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& y^2 + y,\\
q_2 {}={}& y^3 + y^2z + y^2 + yz + y + 1,\\
q_3 {}={}& xy^2 + y^3z + y^2z^2 + y^2z + y^2 + yz^2 + yz + y + z,\\
r {}={}& z.
\end{aligned}$$</p>
<p><strong>Division by $(f_2, f_3, f_1)$ with lex:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& z + 1,\\
q_2 {}={}& xyz^2 + xz^5 + x + yz + y + z^4 + z^3 - z,\\
q_3 {}={}& xz^6 + xz^4 + xz^2 + xz + x + z^5 + z^4 + z^3 + z,\\
r {}={}& z.
\end{aligned}$$</p>
<p>Once again, lex gives some large powers.</p>

<p><strong>Division by $(f_1, f_2, f_3)$ with <a href="../monomial-orderings#grlex">grlex</a>:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& -xz^2,\\
q_2 {}={}& 0,\\
q_3 {}={}& x^2,\\
r {}={}& x^2 + xy - yz.
\end{aligned}$$</p>
<p><strong>Division by $(f_3, f_1, f_2)$ with grlex:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& -x,\\
q_2 {}={}& 0,\\
q_3 {}={}& xy^2,\\
r {}={}& x^2 + xy - yz.
\end{aligned}$$</p>
<p><strong>Division by $(f_2, f_3, f_1)$ with grlex:</strong></p>
<p>$$\begin{aligned}
q_1 {}={}& z + 1,\\
q_2 {}={}& xyz^2 + xz^5 + x + yz + y + z^4 + z^3 - z,\\
q_3 {}={}& xz^6 + xz^4 + xz^2 + xz + x + z^5 + z^4 + z^3 + z
,\\
r {}={}& z.
\end{aligned}$$</p>


## References



1. David A. Cox, John Little, Donal O'Shea, Ideals, Varieties and Algorithms: An Introduction to Computational Algebraic Geometry and Commutative Algebra, Springer, 2015
2. K. Batselier, P. Dreesen, B. De Moor, The geometry of multivariate polynomial division and elimination, SIAM J. Matrix Anal. Appl. 34(1):102-25, 2013, [link](https://ftp.esat.kuleuven.be/pub/SISTA/kbatseli/polydiv.pdf)

